<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Machine Learning</title><meta name=generator content="Hugo 0.74.3"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><link rel=stylesheet href=https://byuistats.github.io/DS250-Course/plugins/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://byuistats.github.io/DS250-Course/plugins/themify-icons/themify-icons.css><link rel=stylesheet href=https://byuistats.github.io/DS250-Course/plugins/highlight/hybrid.css><link rel=icon href=https://byuistats.github.io/DS250-Course/images/favicon.png type=image/x-icon><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700&display=swap" rel=stylesheet><style>:root{--primary-color:#02007e;--body-color:#f9f9f9;--text-color:#636363;--text-color-dark:#242738;--white-color:#ffffff;--light-color:#f8f9fa;--font-family:Roboto}</style><link href=https://byuistats.github.io/DS250-Course/css/style.min.css rel=stylesheet media=screen><script src=https://byuistats.github.io/DS250-Course/plugins/jquery/jquery-1.12.4.js></script><script src=https://byuistats.github.io/DS250-Course/plugins/jquery/jquery-ui.js></script><script src=https://byuistats.github.io/DS250-Course/plugins/bootstrap/bootstrap.min.js></script><script src=https://byuistats.github.io/DS250-Course/plugins/match-height/jquery.matchHeight-min.js></script><script src=https://byuistats.github.io/DS250-Course/plugins/highlight/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-132356198-4','auto');ga('send','pageview');}</script></head><body><header class="shadow-bottom sticky-top bg-white"><nav class="navbar navbar-expand-md navbar-light"><div class=container><a class="navbar-brand px-2" href=/DS250-Course>DS250</a>
<button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation aria-controls=navigation aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse text-center" id=navigation><ul class="navbar-nav ml-auto"><li class=nav-item><a class="nav-link text-dark" href=/DS250-Course>Home</a></li><li class=nav-item><a class="nav-link text-dark" href=/DS250-Course/projects>Projects</a></li><li class=nav-item><a class="nav-link text-dark" href=/DS250-Course/contact>Contact</a></li><li class=nav-item><a class="nav-link text-dark" href=/DS250-Course/course-materials>Materials</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle text-dark" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Navigate</a><div class=dropdown-menu><a class=dropdown-item href=/DS250-Course/slides>Slides</a>
<a class=dropdown-item href=/DS250-Course/course-materials/syllabus/>Syllabus</a>
<a class=dropdown-item href=/DS250-Course/faq>FAQ</a></div></li></ul></div></div></nav></header><section class="single section-sm pb-0"><div class=container><div class=row><div class=col-lg-3><div class=sidebar><ul class=list-styled><a class=back-btn href=/DS250-Course></a><li data-nav-id=https://byuistats.github.io/DS250-Course/skill_builders/ title="Skill Builders" class=sidelist><a href=https://byuistats.github.io/DS250-Course/skill_builders/>Skill Builders</a><ul><li data-nav-id=https://byuistats.github.io/DS250-Course/skill_builders/introduction/ title=Introduction class=sidelist><a href=https://byuistats.github.io/DS250-Course/skill_builders/introduction/>Introduction</a></li><li data-nav-id=https://byuistats.github.io/DS250-Course/skill_builders/pandas_altair/ title="pandas and Altair" class=sidelist><a href=https://byuistats.github.io/DS250-Course/skill_builders/pandas_altair/>pandas and Altair</a></li><li data-nav-id=https://byuistats.github.io/DS250-Course/skill_builders/json_missing/ title="JSONs & missing" class=sidelist><a href=https://byuistats.github.io/DS250-Course/skill_builders/json_missing/>JSONs & missing</a></li><li data-nav-id=https://byuistats.github.io/DS250-Course/skill_builders/relational_data/ title="SQL & databases" class=sidelist><a href=https://byuistats.github.io/DS250-Course/skill_builders/relational_data/>SQL & databases</a></li><li data-nav-id=https://byuistats.github.io/DS250-Course/skill_builders/ml_sklearn/ title="Machine Learning" class="sidelist
active"><a href=https://byuistats.github.io/DS250-Course/skill_builders/ml_sklearn/>Machine Learning</a></li><li data-nav-id=https://byuistats.github.io/DS250-Course/skill_builders/munging/ title="Munging data" class=sidelist><a href=https://byuistats.github.io/DS250-Course/skill_builders/munging/>Munging data</a></li><li data-nav-id=https://byuistats.github.io/DS250-Course/skill_builders/git_github/ title="GitHub and git" class=sidelist><a href=https://byuistats.github.io/DS250-Course/skill_builders/git_github/>GitHub and git</a></li></ul></li></ul></div></div><div class=col-lg-9><div class="p-lg-5 p-4 bg-white"><h2 class=mb-5>Machine Learning</h2><div class=content><h2 id=intro-to-titanic-machine-learning-skill-builder>Intro to Titanic Machine Learning Skill Builder</h2><p><a href=machine_learning.csv>Link to data</a></p><p>For this skill builder, we&rsquo;ll be putting our machine learning hats on. We&rsquo;ll be creating a model that predicts whether a passenger survived. With machine learning, there is a lot of jargon! It can be quite overwhelming at times. This skill builder attempts to keep things basic and simple. With that being said, there are some terms that are important to understand. Let&rsquo;s look at the first few
rows of our dataset before proceeding with the definitions.</p><p><em>The titanic dataset will be used for examples of each definition.</em></p><table><thead><tr><th align=right>survived</th><th align=right>pclass</th><th align=right>sex</th><th align=right>age</th><th align=right>siblings_spouses_aboard</th><th align=right>parents_children_aboard</th><th align=right>fare</th></tr></thead><tbody><tr><td align=right>0</td><td align=right>3</td><td align=right>1</td><td align=right>22</td><td align=right>1</td><td align=right>0</td><td align=right>7.25</td></tr><tr><td align=right>1</td><td align=right>1</td><td align=right>0</td><td align=right>38</td><td align=right>1</td><td align=right>0</td><td align=right>71.2833</td></tr><tr><td align=right>1</td><td align=right>3</td><td align=right>0</td><td align=right>26</td><td align=right>0</td><td align=right>0</td><td align=right>7.925</td></tr><tr><td align=right>1</td><td align=right>1</td><td align=right>0</td><td align=right>35</td><td align=right>1</td><td align=right>0</td><td align=right>53.1</td></tr><tr><td align=right>0</td><td align=right>3</td><td align=right>1</td><td align=right>35</td><td align=right>0</td><td align=right>0</td><td align=right>8.05</td></tr></tbody></table><h3 id=__important-terms__><strong>Important Terms:</strong></h3><ul><li><code>features</code>: measurable property of the object you&rsquo;re trying to predict. We use this information to predict our target of interest.<ul><li><strong>Example</strong>: <em>pclass</em>, <em>sex</em>, <em>age</em>, <em>siblings_spouses_aboard</em> , <em>parents_children_aboard</em>, <em>fare</em> columns are all examples of different features.</li><li><strong>Synonyms</strong>: attributes, explanatory variables, independent variables, variables, X&rsquo;s, covariates</li></ul></li><li><code>target</code>: the feature that you are wanting to gain more insight into. The thing you are trying to predict.<ul><li><strong>Example</strong>: in the titanic dataset our target is <em>survived</em></li><li><strong>Synonyms</strong>: label, dependent variable, y</li></ul></li><li><code>train set</code>: Usually 70% of the rows from the original dataset are randomly sampled to create this training data. It&rsquo;s used by the algorithm, to determine, or learn, the optimal combinations of variables that will generate a good predictive model<ul><li><strong>Example</strong>: Random sample of 70% of the original titanic dataset rows</li><li><strong>Synonyms</strong>: training data, train data, X_train, y_train</li></ul></li><li><code>test set</code>: Usually the remaining 30% of the rows in the original dataset are used to create this dataset. The testing data is a set of rows used only to assess the performance (i.e. generalization) of a model. To do this, the final model is used to predict classifications of examples in the test set. Those predictions are compared to the examples&rsquo; true classifications to assess the model&rsquo;s accuracy.<ul><li><strong>Example</strong>: Random sample of 30% of the original titanic dataset rows</li><li><strong>Synonyms</strong>: testing data, test data, X_test, y_test</li></ul></li><li><code>evaluation metrics</code>: A statistic that tells you how well your predictions align with the actual values. Other words, tells you how good your model is.<ul><li><strong>Example</strong>: Accuracy, Precision, Recall, MSE, MAE, Rsquared</li><li><strong>Synonyms</strong>: performance metric</li></ul></li></ul><p>Again, this is a very light and oversimplified treatment of machine learning. The purpose of this project is to help you understand the main concepts of ml and walk you through the process of building a machine learning model. A simplified work flow of a machine learning project is shown below. Spend some time getting familiar with this flow &mdash as you are about to code it&mldr; Exciting!</p><p><em>Note in order to do this skill builder you will need to have <code>scikit-learn</code> installed on your machine. Run the following command in your terminal if you haven&rsquo;t already.</em></p><p><em><code>pip install scikit-learn</code></em></p><h3 id=data>Data</h3><p><a href=machine_learning.csv>Link to csv file</a></p><h3 id=exercise-0-imports-and-loading-in-data>Exercise 0 (Imports and Loading in data)</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># Loading in packages</span>
<span style=color:#f92672>import</span> pandas <span style=color:#f92672>as</span> pd
<span style=color:#f92672>import</span> numpy <span style=color:#f92672>as</span> np
<span style=color:#f92672>import</span> altair <span style=color:#f92672>as</span> alt
<span style=color:#f92672>from</span> sklearn.model_selection <span style=color:#f92672>import</span> train_test_split
<span style=color:#f92672>from</span> sklearn.ensemble <span style=color:#f92672>import</span> RandomForestClassifier
<span style=color:#f92672>from</span> sklearn.metrics <span style=color:#f92672>import</span> accuracy_score

<span style=color:#75715e># Loading in data</span>
data <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(___)
</code></pre></div><hr><h3 id=exercise-1>Exercise 1</h3><p>Create a chart exploring the relationship between <em>age</em> and <em>survived</em> in the titanic dataset. A strip plot, density plot, or boxplot might be useful here. Below is an example of a density plot. Feel free to replicate this chart or create your own.</p><p>The purpose of making this chart is to explore the relationships between a feature and the target. We want to see if the feature contains predictive information about the target. This is a large part of machine learning called Exploratory Data Analysis that should never be skipped! Spend time getting to know your features and how they interact with other features and the target.</p><p><img src=titanic.png alt></p><hr><h3 id=exercise-2>Exercise 2</h3><p>Build a random forest model that is able to predict whether a passenger survived. <strong>This exercise is the bulk of the skill builder and contains several steps.</strong></p><h4 id=step-0-split-the-data-into-x-and-y-variables>Step 0: Split the data into X and y variables</h4><p>The X variable will contain all your features</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># Removes the target and keeps all features</span>
X <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>drop(___, axis<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)  
</code></pre></div><p>The y variable will hold the target</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># Selects the target column</span>
y <span style=color:#f92672>=</span> data[<span style=color:#e6db74>&#39;___&#39;</span>]  
</code></pre></div><h4 id=step-1-split-data-into-train-and-test-sets>Step 1: Split data into train and test sets</h4><p>The <code>train_test_split</code> function is useful for this task. Review the <a href=https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html>train_test_split function documentation</a></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># Splitting X and y variables into train and test sets using stratified sampling</span>
X_train, X_test, y_train, y_test <span style=color:#f92672>=</span> train_test_split(___, ___, test_size<span style=color:#f92672>=</span><span style=color:#ae81ff>0.3</span>,
                                                    random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>24</span>, stratify<span style=color:#f92672>=</span>y)
</code></pre></div><h4 id=step-2-train-the-model>Step 2: Train the model</h4><p>Explore the <a href=https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html>RandomForestClassifier documentation</a> for the RandomForestClassifier. It&rsquo;s not necessary to understand the inner workings of the Random Forest algorithm for this class - just learn the syntax of fitting the model.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># Creating random forest object</span>
rf <span style=color:#f92672>=</span> RandomForestClassifier(random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>24</span>)  

<span style=color:#75715e># Fit with the training data</span>
rf<span style=color:#f92672>.</span>fit(___, ___)  
</code></pre></div><h4 id=step-3-use-test-set-to-make-predictions>Step 3: Use test set to make predictions</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># Using the features in the test set to make predictions</span>
y_pred <span style=color:#f92672>=</span> rf<span style=color:#f92672>.</span>predict(___)  
</code></pre></div><h4 id=step-4-compare-test-set-predictions-to-actual-values-calculate-the-accuracy>Step 4: Compare test set predictions to actual values. Calculate the accuracy.</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># Comparing predictions to actual values</span>
accuracy_score(___, ___)  
</code></pre></div><hr><h3 id=exercise-3>Exercise 3</h3><p>What is the most important feature in making predictions? Why do you think this is?</p><p>Create a table that shows the feature importances in descending order. The random forest classifier has a feature importances attribute. It can be accessed by
<code>rf.feature_importances_</code>. The table should look something like this.</p><table><thead><tr><th align=left>feature names</th><th align=right>importances</th></tr></thead><tbody><tr><td align=left>fare</td><td align=right>0.288051</td></tr><tr><td align=left>sex</td><td align=right>0.281853</td></tr><tr><td align=left>age</td><td align=right>0.266491</td></tr><tr><td align=left>pclass</td><td align=right>0.0814224</td></tr><tr><td align=left>siblings_spouses_aboard</td><td align=right>0.0475633</td></tr><tr><td align=left>parents_children_aboard</td><td align=right>0.034619</td></tr></tbody></table><div class="card mb-4 rounded-0 shadow border-0"><div class="card-header rounded-0 bg-white border p-0 border-0"><a class="card-link h4 d-flex tex-dark mb-0 py-3 px-4 justify-content-between" data-toggle=collapse href=#after-you-have-completed-this-skill-builder-with-your-team-or-on-your-own-then-compare-your-work-to-our-script><span>After you have completed this skill builder with your team (or on your own) then compare your work to our script</span> <i class="ti-plus text-primary text-right"></i></a></div><div id=after-you-have-completed-this-skill-builder-with-your-team-or-on-your-own-then-compare-your-work-to-our-script class=collapse data-parent=#accordion><div class="card-body font-secondary text-color"><strong>See the <a href=machine_learning.py>script</a>.</strong></div></div></div></div><p class="post-meta border-bottom pb-3 mb-0 mt-3">Updated on 15 Sep 2020</p><nav class="pagination mt-3"><a class="nav nav-prev" href=https://byuistats.github.io/DS250-Course/skill_builders/relational_data/><i class="ti-arrow-left mr-2"></i><span class="d-none d-md-block">SQL & databases</span></a>
<a class="nav nav-next" href=https://byuistats.github.io/DS250-Course/skill_builders/munging/><span class="d-none d-md-block">Munging data</span><i class="ti-arrow-right ml-2"></i></a></nav></div></div></div></div></section><footer class="section pb-4"><div class=container><div class="row align-items-center"><div class="col-md-8 text-md-left text-center"><p class="mb-md-0 mb-4">J. Hathaway and BYU-I ©</p></div><div class="col-md-4 text-md-right text-center"><ul class=list-inline><li class=list-inline-item><a class="text-color d-inline-block p-2" href=https://github.com/byuidatascience><i class=ti-github></i></a></li><li class=list-inline-item><a class="text-color d-inline-block p-2" href=https://www.linkedin.com/groups/13537407/><i class=ti-linkedin></i></a></li></ul></div></div></div></footer><script src=https://byuistats.github.io/DS250-Course/js/script.min.js></script></body></html>