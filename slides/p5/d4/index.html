<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Day 4: May the ML columns be with you</title><meta name=generator content="Hugo 0.74.3"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><link rel=stylesheet href=https://byuistats.github.io/DS250-Comeau/plugins/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://byuistats.github.io/DS250-Comeau/plugins/themify-icons/themify-icons.css><link rel=stylesheet href=https://byuistats.github.io/DS250-Comeau/plugins/highlight/hybrid.css><link rel=icon href=https://byuistats.github.io/DS250-Comeau/images/favicon.png type=image/x-icon><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700&display=swap" rel=stylesheet><style>:root{--primary-color:#02007e;--body-color:#f9f9f9;--text-color:#636363;--text-color-dark:#242738;--white-color:#ffffff;--light-color:#f8f9fa;--font-family:Roboto}</style><link href=https://byuistats.github.io/DS250-Comeau/css/style.min.css rel=stylesheet media=screen><script src=https://byuistats.github.io/DS250-Comeau/plugins/jquery/jquery-1.12.4.js></script><script src=https://byuistats.github.io/DS250-Comeau/plugins/jquery/jquery-ui.js></script><script src=https://byuistats.github.io/DS250-Comeau/plugins/bootstrap/bootstrap.min.js></script><script src=https://byuistats.github.io/DS250-Comeau/plugins/match-height/jquery.matchHeight-min.js></script><script src=https://byuistats.github.io/DS250-Comeau/plugins/highlight/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-132356198-4','auto');ga('send','pageview');}</script></head><body><header class="shadow-bottom sticky-top bg-white"><nav class="navbar navbar-expand-md navbar-light"><div class=container><a class="navbar-brand px-2" href=/DS250-Comeau>DS250</a>
<button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation aria-controls=navigation aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse text-center" id=navigation><ul class="navbar-nav ml-auto"><li class=nav-item><a class="nav-link text-dark" href=/DS250-Comeau>Home</a></li><li class=nav-item><a class="nav-link text-dark" href=/DS250-Comeau/projects>Projects</a></li><li class=nav-item><a class="nav-link text-dark" href=/DS250-Comeau/contact>Contact</a></li><li class=nav-item><a class="nav-link text-dark" href=/DS250-Comeau/course-materials>Materials</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle text-dark" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Navigate</a><div class=dropdown-menu><a class=dropdown-item href=/DS250-Comeau/slides>Slides</a>
<a class=dropdown-item href=/DS250-Comeau/course-materials/syllabus/>Syllabus</a>
<a class=dropdown-item href=/DS250-Comeau/faq>FAQ</a></div></li></ul></div></div></nav></header><section class="single section-sm pb-0"><div class=container><div class=row><div class=col-lg-3><div class=sidebar><ul class=list-styled><a class=back-btn href=/DS250-Comeau></a><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/ title=Slides class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/>Slides</a><ul><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p6/ title="Week 12-13: Project 6 - Github" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p6/>Week 12-13: Project 6 - Github</a><ul><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p6/d4/ title="Day 3: Resume Fork and Merge" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p6/d4/>Day 3: Resume Fork and Merge</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p6/d3/ title="Day 2: Commit, push, fork, and merge" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p6/d3/>Day 2: Commit, push, fork, and merge</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p6/d2/ title="Day 1: Git and Github" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p6/d2/>Day 1: Git and Github</a></li></ul></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p5/ title="Week 10-11: Project 5 - Star Wars" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p5/>Week 10-11: Project 5 - Star Wars</a><ul><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p5/d4/ title="Day 4: May the ML columns be with you" class="sidelist
active"><a href=https://byuistats.github.io/DS250-Comeau/slides/p5/d4/>Day 4: May the ML columns be with you</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p5/d3/ title="Day 3: Validating data, cleaning columns" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p5/d3/>Day 3: Validating data, cleaning columns</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p5/d2/ title="Day 2: Star Wars and strings" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p5/d2/>Day 2: Star Wars and strings</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p5/d1/ title="Day 1: The war with Star Wars" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p5/d1/>Day 1: The war with Star Wars</a></li></ul></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p4/ title="Week 8-9: Project 4 - Homes" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p4/>Week 8-9: Project 4 - Homes</a><ul><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p4/d4/ title="Day 4: Evaluating Our Models, Part 2" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p4/d4/>Day 4: Evaluating Our Models, Part 2</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p4/d3/ title="Day 3: Training a Classifier, Part 2" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p4/d3/>Day 3: Training a Classifier, Part 2</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p4/d2/ title="Day 2: Intro to Machine Learning" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p4/d2/>Day 2: Intro to Machine Learning</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p4/d1/ title="Day 1: Intro to ML" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p4/d1/>Day 1: Intro to ML</a></li></ul></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p3/ title="Week 6-7: Project 3 - Baseball" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p3/>Week 6-7: Project 3 - Baseball</a><ul><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p3/d3/ title="Day 3: The end of baseball" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p3/d3/>Day 3: The end of baseball</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p3/d2/ title="Day 2: SQL Calculations" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p3/d2/>Day 2: SQL Calculations</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p3/d1/ title="Day 1: Intro to Project 3" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p3/d1/>Day 1: Intro to Project 3</a></li></ul></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p2/ title="Week 4-5: Project 2 - Flights" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p2/>Week 4-5: Project 2 - Flights</a><ul><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p2/d4/ title="Day 4: Exporting JSON" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p2/d4/>Day 4: Exporting JSON</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p2/d3/ title="Day 3: Missing Data" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p2/d3/>Day 3: Missing Data</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p2/d2/ title="Day 2: Transforming Data" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p2/d2/>Day 2: Transforming Data</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p2/d1/ title="Day 1: Intro to Flights Data" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p2/d1/>Day 1: Intro to Flights Data</a></li></ul></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p1/ title="Week 2-3: Project 1 - Names" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p1/>Week 2-3: Project 1 - Names</a><ul><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p1/d4/ title="Day 4: Telling the story of names" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p1/d4/>Day 4: Telling the story of names</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p1/d3/ title="Day 3: Making your name stand out" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p1/d3/>Day 3: Making your name stand out</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p1/d2/ title="Day 2: Seeing names with Altair" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p1/d2/>Day 2: Seeing names with Altair</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/p1/d1/ title="Day 1: Exploring names with pandas" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/p1/d1/>Day 1: Exploring names with pandas</a></li></ul></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/introduction/ title="Week 1: Introduction" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/introduction/>Week 1: Introduction</a><ul><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/introduction/day02/ title="Day 2: Project 0" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/introduction/day02/>Day 2: Project 0</a></li><li data-nav-id=https://byuistats.github.io/DS250-Comeau/slides/introduction/day01/ title="Day 1: Welcome" class=sidelist><a href=https://byuistats.github.io/DS250-Comeau/slides/introduction/day01/>Day 1: Welcome</a></li></ul></li></ul></li></ul></div></div><div class=col-lg-9><div class="p-lg-5 p-4 bg-white"><h2 class=mb-5>Day 4: May the ML columns be with you</h2><div class=content><h2 id=welcome-to-class>Welcome to class!</h2><h4 id=spiritual-thought>Spiritual Thought</h4><h4 id=announcements>Announcements</h4><br><h2 id=getting-the-data-ready-for-machine-learning>Getting the data ready for machine learning.</h2><br><h3 id=what-are-machine-learning-algorithms-expecting-to-see>What are machine learning algorithms expecting to see?</h3><blockquote><p>We need to handle missing values and categorical features before feeding the data into a machine learning algorithm, because the mathematics underlying most machine learning models assumes that the data is numerical and contains no missing values. To reinforce this requirement, scikit-learn will return an error if you try to train a model using data that contain missing values or non-numeric values when working with models like linear regression and logistic regression. <a href=https://www.dataquest.io/blog/machine-learning-preparing-data/>ref</a></p></blockquote><p>We have some options when converting categorical features (columns) to numeric.</p><ul><li>If the <strong>category contains numeric information</strong> (like a range of numbers) we can convert it to a numeric variable by taking the minimum, average, or maximum of the range.</li><li><strong>Factorization:</strong> If the category is an <strong>&ldquo;ordinal&rdquo;</strong> variable (meaning, <a href="https://www.questionpro.com/blog/nominal-ordinal-interval-ratio/#:~:text=Nominal%20scale%20is%20a%20naming,each%20of%20its%20variable%20options.">there is an order to the categories</a>) we can assign each category to an integer. (For example, good = 1, better = 2, best = 3.)</li><li><strong>One-hot Encoding or Dummy Variables:</strong> If the category is a <strong>&ldquo;nominal&rdquo;</strong> variable (without an order) then we need to use one-hot encoding (sometimes called &ldquo;<a href=https://machinelearningmastery.com/one-hot-encoding-for-categorical-data/>dummy variable encoding</a>").</li><li>If the <strong>category is some version of True/False or Yes/No</strong> then we can simply convert the values to zeros and ones.</li></ul><br><h1 id=whats-our-game-plan-for-the-star-wars-columns>What&rsquo;s our game plan for the Star Wars columns?</h1><h3 id=1-break-into-groups>1. Break into Groups</h3><h4 id=strategize--code--share>Strategize + Code + Share</h4><ul><li>Group 1: How are you going to turn Age, Income and Education into numbers?</li><li>Group 2: How are you going to encode<ul><li>Who Shot First</li><li>Gender</li><li>Location</li><li>All the Yes/No responses</li></ul></li><li>Group 3: How are you going to deal with the character rankings?</li></ul><h3 id=2-combine-all-the-factors-into-one-big-x-dataframe>2. Combine all the factors into one big X dataframe</h3><h3 id=3-define-y-as-those-making--50k>3. Define Y as those making > $50k</h3><p><strong>First:</strong> Limit the data to only people who answered &ldquo;Yes&rdquo; to the question &ldquo;Have you seen any of the 6 films in the Star Wars franchise?&rdquo;.</p><p><strong>Then:</strong> Use the table below as a guide to prepare your data for machine learning.</p><table><thead><tr><th>Column</th><th>Original Format</th><th>Convert To</th></tr></thead><tbody><tr><td>age</td><td>category (ordinal, age ranges)</td><td>number</td></tr><tr><td>income</td><td>category (ordinal, income ranges)</td><td>number</td></tr><tr><td>education</td><td>category (ordinal, name of degree)</td><td>number</td></tr><tr><td>shot_first</td><td>category (nominal)</td><td>one-hot</td></tr><tr><td>gender</td><td>category (nominal)</td><td>one-hot</td></tr><tr><td>location</td><td>category (nominal)</td><td>one-hot</td></tr><tr><td>fan_star_wars</td><td>Yes/No</td><td>0/1</td></tr><tr><td>expanded_universe</td><td>Yes/No</td><td>0/1</td></tr><tr><td>fan_exapanded</td><td>Yes/No</td><td>0/1</td></tr><tr><td>fan_star_trek</td><td>Yes/No</td><td>0/1</td></tr><tr><td>seen_i</td><td>Yes/No (name of movie/NaN)</td><td>0/1</td></tr><tr><td>seen_ii</td><td>Yes/No (name of movie/NaN)</td><td>0/1</td></tr><tr><td>seen_iii</td><td>Yes/No (name of movie/NaN)</td><td>0/1</td></tr><tr><td>seen_iv</td><td>Yes/No (name of movie/NaN)</td><td>0/1</td></tr><tr><td>seen_v</td><td>Yes/No (name of movie/NaN)</td><td>0/1</td></tr><tr><td>seen_vi</td><td>Yes/No (name of movie/NaN)</td><td>0/1</td></tr><tr><td>movie rankings</td><td>number</td><td>-</td></tr><tr><td>character rankings</td><td>category (ordinal)</td><td>one-hot or factorize</td></tr></tbody></table><br><h3 id=what-functions-can-we-use-to-convert-the-categorical-columns-to-numeric>What functions can we use to convert the categorical columns to numeric?</h3><ul><li>Range of numbers: <a href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.split.html>str.split()</a> and <a href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.astype.html>astype()</a></li><li>Ordinal: <a href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.replace.html>str.replace()</a></li><li>Ordinal: <a href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.factorize.html>pd.factorize()</a> (can also be used for True/False)</li><li>Nominal: <a href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.get_dummies.html>pd.get_dummies()</a></li></ul><div class="card mb-4 rounded-0 shadow border-0"><div class="card-header rounded-0 bg-white border p-0 border-0"><a class="card-link h4 d-flex tex-dark mb-0 py-3 px-4 justify-content-between" data-toggle=collapse href=#using-the-drop_first-true-option-in-get_dummies><span>Using the <code>drop_first = True</code> option in <code>get_dummies()</code></span> <i class="ti-plus text-primary text-right"></i></a></div><div id=using-the-drop_first-true-option-in-get_dummies class=collapse data-parent=#accordion><div class="card-body font-secondary text-color"><p>Question: When and why would we drop the first column when we convert a category using <code>pd.get_dummies()</code>?</p><p>Answer: Whenever your algorithm needs to calculate a matrix inverse.</p><blockquote><p>The one-hot encoding creates one binary variable for each category.</p><br><p>The problem is that this representation includes redundancy. For example, if we know that [1, 0, 0] represents &ldquo;blue&rdquo; and [0, 1, 0] represents &ldquo;green&rdquo; we don&rsquo;t need another binary variable to represent &ldquo;red&rdquo;, instead we could use 0 values for both &ldquo;blue&rdquo; and &ldquo;green&rdquo; alone, e.g. [0, 0].</p><br><p>This is called a dummy variable encoding, and always represents C categories with C-1 binary variables. In addition to being slightly less redundant, a dummy variable representation is required for some models.</p><br><p>For example, in the case of a linear regression model (and other regression models that have a bias term), a one hot encoding will case the matrix of input data to become singular, meaning it cannot be inverted and the linear regression coefficients cannot be calculated using linear algebra. For these types of models a dummy variable encoding must be used instead.</p></blockquote><p><a href=https://machinelearningmastery.com/one-hot-encoding-for-categorical-data/>Source</a></p></div></div></div><br><h2 id=predicting-income>Predicting income.</h2><p><strong>Grand Question 4</strong> wants us to &ldquo;build a machine learning model that predicts whether a person makes more than $50k&rdquo;.</p><div class="card mb-4 rounded-0 shadow border-0"><div class="card-header rounded-0 bg-white border p-0 border-0"><a class="card-link h4 d-flex tex-dark mb-0 py-3 px-4 justify-content-between" data-toggle=collapse href=#what-is-the-target-were-interested-in><span>What is the target we&rsquo;re interested in?</span> <i class="ti-plus text-primary text-right"></i></a></div><div id=what-is-the-target-were-interested-in class=collapse data-parent=#accordion><div class="card-body font-secondary text-color"><p>Aka, what is our &ldquo;outcome&rdquo; or &ldquo;response&rdquo; that we want to predict?</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>dat_ml<span style=color:#f92672>.</span>income <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>50000</span>
</code></pre></div></div></div></div><div class="card mb-4 rounded-0 shadow border-0"><div class="card-header rounded-0 bg-white border p-0 border-0"><a class="card-link h4 d-flex tex-dark mb-0 py-3 px-4 justify-content-between" data-toggle=collapse href=#how-to-format-the-features-x-and-target-y><span>How to format the features (x) and target (y)</span> <i class="ti-plus text-primary text-right"></i></a></div><div id=how-to-format-the-features-x-and-target-y class=collapse data-parent=#accordion><div class="card-body font-secondary text-color"><p>Remember not to include the answer (income) in your features!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>x <span style=color:#f92672>=</span> dat_ml<span style=color:#f92672>.</span>drop([<span style=color:#e6db74>&#39;income&#39;</span>], axis <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>)
</code></pre></div><p>The response needs to be saved as a 0/1 variable (at least, for binary classification algorithms).</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>y <span style=color:#f92672>=</span> (dat_ml<span style=color:#f92672>.</span>income <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>50000</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>1</span>
</code></pre></div></div></div></div><br></div><p class="post-meta border-bottom pb-3 mb-0 mt-3">Updated on 12 Oct 2020</p><nav class="pagination mt-3"><a class="nav nav-prev" href=https://byuistats.github.io/DS250-Comeau/slides/p5/><i class="ti-arrow-left mr-2"></i><span class="d-none d-md-block">Week 10-11: Project 5 - Star Wars</span></a>
<a class="nav nav-next" href=https://byuistats.github.io/DS250-Comeau/slides/p5/d3/><span class="d-none d-md-block">Day 3: Validating data, cleaning columns</span><i class="ti-arrow-right ml-2"></i></a></nav></div></div></div></div></section><footer class="section pb-4"><div class=container><div class="row align-items-center"><div class="col-md-8 text-md-left text-center"><p class="mb-md-0 mb-4">J. Hathaway and BYU-I ©</p></div><div class="col-md-4 text-md-right text-center"><ul class=list-inline><li class=list-inline-item><a class="text-color d-inline-block p-2" href=https://github.com/byuidatascience><i class=ti-github></i></a></li><li class=list-inline-item><a class="text-color d-inline-block p-2" href=https://www.linkedin.com/groups/13537407/><i class=ti-linkedin></i></a></li></ul></div></div></div></footer><script src=https://byuistats.github.io/DS250-Comeau/js/script.min.js></script></body></html>